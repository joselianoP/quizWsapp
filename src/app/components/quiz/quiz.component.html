<div class="tituloCentralizado">
  <h1>AWS Certified Cloud Practitioner</h1>
</div>

<div *ngIf="perguntas.length > 0">
  <!-- Exibe a pergunta atual e o total de perguntas -->
  <div class="question-counter">
    <h3 class="question-counter">
      Pergunta {{ currentQuestionIndex + 1 }} de {{ perguntas.length }}
    </h3>
  </div>

  <h4 class="small-font">
    {{ currentQuestionIndex + 1 }}.
    {{ perguntas[currentQuestionIndex].pergunta }}
  </h4>
  <div>
    <mat-card>
      <ng-container
        *ngIf="
          !isMultipleChoice(perguntas[currentQuestionIndex].respostaCorreta)
        "
      >
        <mat-radio-group
          [(ngModel)]="respostasSelecionadas[currentQuestionIndex]"
        >
          <mat-radio-button
            *ngFor="
              let opcao of perguntas[currentQuestionIndex].opcoes;
              let i = index
            "
            [ngClass]="{
              'nao-clicavel': respostasVerificadas[currentQuestionIndex]
            }"
            [value]="opcao.texto"
            (click)="onSelectOption(currentQuestionIndex, opcao.texto, false)"
          >
            <label
              [ngClass]="{
                correta:
                  respostasVerificadas[currentQuestionIndex] &&
                  respostasCorretas[currentQuestionIndex][i],
                incorreta:
                  respostasVerificadas[currentQuestionIndex] &&
                  !respostasCorretas[currentQuestionIndex][i]
              }"
            >
              {{ opcao.texto }}
              <!-- Ajuste para exibir o texto da opção -->
            </label>
            <div
              *ngIf="respostasVerificadas[currentQuestionIndex]"
              class="explicacaoRadio"
            >
              <p>{{ opcao.explicacao }}</p>
            </div>
          </mat-radio-button>
        </mat-radio-group>
      </ng-container>

      <ng-container
        *ngIf="
          isMultipleChoice(perguntas[currentQuestionIndex].respostaCorreta)
        "
      >
        <div *ngFor="let opcao of perguntas[currentQuestionIndex].opcoes">
          <mat-checkbox
            [ngClass]="{
              'nao-clicavel': respostasVerificadas[currentQuestionIndex]
            }"
            [checked]="
              respostasSelecionadas[currentQuestionIndex]?.includes(opcao.texto)
            "
            (change)="onSelectOption(currentQuestionIndex, opcao.texto, true)"
          >
            <label
              [ngClass]="{
                correta:
                  respostasVerificadas[currentQuestionIndex] &&
                  respostasCorretas[currentQuestionIndex][
                    perguntas[currentQuestionIndex].opcoes.indexOf(opcao)
                  ],
                incorreta:
                  respostasVerificadas[currentQuestionIndex] &&
                  respostasSelecionadas[currentQuestionIndex]?.includes(
                    opcao.texto
                  ) &&
                  !respostasCorretas[currentQuestionIndex][
                    perguntas[currentQuestionIndex].opcoes.indexOf(opcao)
                  ]
              }"
            >
              {{ opcao.texto }}
            </label>
          </mat-checkbox>
          <div
            *ngIf="respostasVerificadas[currentQuestionIndex]"
            class="explicacao"
          >
            <p>{{ opcao.explicacao }}</p>
            <!-- Exibir explicação da opção -->
          </div>
        </div>
      </ng-container>

      <!-- Botões de navegação -->
      <div class="navigation-buttons">
        <button routerLink="/" class="verificar-respostas-btn">Home</button>

        <button
          class="verificar-respostas-btn"
          (click)="nextQuestion()"
          [disabled]="currentQuestionIndex === perguntas.length - 1"
        >
          Próxima
        </button>

        <button
          class="verificar-respostas-btn"
          (click)="previousQuestion()"
          [disabled]="currentQuestionIndex === 0"
        >
          Anterior
        </button>

        <!-- Botão Verificar Respostas -->
        <button
          (click)="verificarResposta()"
          *ngIf="
            !simuladoFinalizado && currentQuestionIndex != perguntas.length - 1
          "
          class="verificar-respostas-btn"
        >
          Verificar Resposta
        </button>

        <button
          (click)="finalizar()"
          *ngIf="
            !simuladoFinalizado && currentQuestionIndex === perguntas.length - 1
          "
          class="verificar-respostas-btn"
        >
          Finalizar
        </button>
      </div>

      <!-- Resultado -->
      <div *ngIf="resultado">
        <p [innerHTML]="resultado"></p>
      </div>

      <div *ngIf="acertosPorDominioMensagem">
        <p [innerHTML]="acertosPorDominioMensagem"></p>
      </div>
    </mat-card>
  </div>
</div>
